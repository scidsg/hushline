{% extends "base.html" %}
{% block title %}Directory{% endblock %}
{% block content %}
<h2>User Directory</h2>
{% if not logged_in %}
<p class="helper section-intro">👋 Hush Line connects whistleblowers with lawyers, journalists, business leaders, 
    and more. <mark class="highlight">We advise speaking to a legal professional before taking any confidential information from your workplace.</mark></p>
{% endif %}
<div class="directory-tabs" data-per-page="{{usersPerPage}}">
    <ul class="tab-list" role="tablist">
        <li role="presentation">
            <button type="button" class="tab {% if not isViewAllRoute %}active{% endif %}" data-tab="verified" role="tab" aria-selected="{% if not isViewAllRoute %}true {% else %}false{% endif %}"
                aria-controls="verified" id="verified-tab" type="button">Verified</button>
        </li>
        <li role="presentation">
            <button type="button" class="tab {% if isViewAllRoute %}active{% endif %}" data-tab="all" role="tab"  aria-selected="{% if isViewAllRoute %}true {% else %}false{% endif %}" aria-controls="all"
                id="all-tab" type="button">All</button>
        </li>
    </ul>
</div>
<div class="search-box">
    <label id="searchIcon" for="searchInput" aria-label="Search users">
        <img src="{{ url_for('static', filename='img/app/icon-search.png') }}" alt="">
    </label>
     <input type="text" id="searchInput" placeholder="Search{% if  not isViewAllRoute %} verified{% endif %} users...">
    <button id="clearIcon" type="button" style="cursor: pointer;" aria-label="Clear search field">&times;</button>
</div>
<div id="verified" class="tab-content {% if not isViewAllRoute %}active{% endif %}" role="tabpanel" aria-labelledby="verified-tab" hidden="{% if not isViewAllRoute %}false{% endif %}">
    {% if not logged_in %}
    <p class="meta dirMeta">⭐️ Verified accounts are offered to individuals who have
        have manually verified their identities with a member of our staff. <a
            href="https://github.com/scidsg/hushline/blob/main/docs/3-managed-service.md#verified-accounts"
            target="_blank" rel="noopener noreferrer">Learn more about verification</a>.</p>
    {% endif %}
    <div class="user-list">
        {% for user in users %}
        {% if user.is_verified and user.show_in_directory %}
        <article class="user">
            <h3>{{ user.display_name or user.primary_username }}</h3>
            {% if user.primary_username %}
            <p class="meta">@{{ user.primary_username }}</p>
            {% endif %}
            {% if user.is_verified or user.is_admin %}
            <div class="badgeContainer">
                {% if user.is_admin %}
                <p class="badge">⚙️ Admin</p>
                {% endif %}
                {% if user.is_verified %}
                <p class="badge">⭐️ Verified</p>
                {% endif %}
            </div>
            {% endif %}
            {% if user.bio %}
            <p class="bio">{{ user.bio }}</p>
            {% endif %}
            <div class="user-actions">
                <a href="{{ url_for('submit_message', username=user.primary_username) }}">Send a Message</a>
                {% if logged_in %}
                <a href="#" class="report-link" data-username="{{ user.primary_username }}"
                    data-display-name="{{ user.display_name or user.primary_username }}"
                    data-bio="{{ user.bio }}">Report Account</a>
                {% endif %}
            </div>
        </article>
        {% endif %}
        {% else %}
        <p class="empty-message"><span class="emoji-message">🙈</span><br>Nothing to see here...</p>
        {% endfor %}
    </div>
    <ul class="pagination verified"></ul>
</div>
<div id="all" class="tab-content {% if isViewAllRoute %} active{% endif %}" role="tabpanel"  aria-labelledby="all-tab" hidden="{% if isViewAllRoute %}false{% endif %}">
    <div class="user-list">
        {% for user in users %}
        {% if user.show_in_directory %}
        <article class="user">
            <h3>{{ user.display_name or user.primary_username }}</h3>
            {% if user.primary_username %}
            <p class="meta">@{{ user.primary_username }}</p>
            {% endif %}
            {% if user.is_verified or user.is_admin %}
            <div class="badgeContainer">
                {% if user.is_admin %}
                <p class="badge">⚙️ Admin</p>
                {% endif %}
                {% if user.is_verified %}
                <p class="badge">⭐️ Verified</p>
                {% endif %}
            </div>
            {% endif %}
            {% if user.bio %}
            <p class="bio">{{ user.bio }}</p>
            {% endif %}
            <div class="user-actions">
                <a href="{{ url_for('submit_message', username=user.primary_username) }}">Send a Message</a>
                {% if logged_in %}
                <a href="#" class="report-link" data-username="{{ user.primary_username }}"
                    data-display-name="{{ user.display_name or user.primary_username }}"
                    data-bio="{{ user.bio }}">Report Account</a>
                {% endif %}
            </div>
        </article>
        {% endif %}
        {% else %}
        <p class="empty-message"><span class="emoji-message">🙈</span><br>Nothing to see here...</p>
        {% endfor %}
    </div>
    <ul class="pagination all"></ul>
</div>
{% endblock %}
{% block scripts %}
<script src="{{ url_for('static', filename='js/directory.js') }}"></script>
{% endblock %}